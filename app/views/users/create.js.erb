<% if @user.errors.empty? %>
  jQuery("#errors").html("");
  jQuery(".cancel").trigger("click");
  jQuery("#listings").html("<%= escape_javascript(render :partial => "list", :locals => {:users => @users}) %>");
  jQuery("#users_table").tablesorter({widthFixed: true, widgets: ['zebra']}).tablesorterPager({container: jQuery("#pager"), size: 5});
<% else %>
  alert(<%= @user.errors.count %>);
  jQuery("#errors").html("<%= escape_javascript(render :partial => "shared/error_messages", :locals => {:target => @user}) %>");
  jQuery("#errors").append("<%= escape_javascript(render :partial => "shared/error_messages", :locals => {:target => @user.email_accounts}) %>");
<% end %>
